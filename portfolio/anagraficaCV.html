<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <title>Anagrafica JSON</title>
</head>
<body>
    
    <h1 class="titolo">Anagrafica JSON</h1>
    <input type="button" onclick="caricaDati()" value="Carica i dati">

    <div id="risForm" style="visibility: hidden;">
        <div id="stringaJSON"></div>
    </div>

    <script>
        function caricaDati() {
            var file = new XMLHttpRequest();
            file.open("GET", "https://raw.githubusercontent.com/alelallox/JavaScript-Works/refs/heads/main/portfolio/datiAnagrafica.json", true);
            file.send();
            file.onreadystatechange = function() {
                if (this.readyState == 4 && this.status == 200) {
                    var jsonDoc = JSON.parse(file.responseText);
                    creaTabella(jsonDoc);
                }
            };
            document.getElementById("risForm").style.visibility = "visible";
        }

        function creaTabella(ogg) {
            // Svuota il contenuto precedente
            document.getElementById("stringaJSON").innerHTML = '';

            var tabella = document.createElement("table");
            var intestazioneCampi = ["Immagine", "Nome", "Cognome", "Età", "Indirizzo", "Città", "Telefono 1", "Telefono 2", "Sport 1", "Sport 2", "Portfolio"];
            var intestazione = document.createElement("tr");

            // Crea l'intestazione della tabella
            intestazioneCampi.forEach(function(campo) {
                var header = document.createElement("th");
                header.appendChild(document.createTextNode(campo));
                intestazione.appendChild(header);
            });
            tabella.appendChild(intestazione);

            // Crea le righe della tabella
            ogg.persone.forEach(function(persona) {
                var colonna = document.createElement("tr");

                // Colonna immagine
                var immagineCell = document.createElement("td");
                var link = document.createElement("a");
                link.href = `dettaglio.html?id=${persona.id}`;
                link.target = "_blank";
                var img = document.createElement("img");
                img.src = persona.thumb || "placeholder.png"; // Placeholder in caso di immagine mancante
                img.alt = "Immagine di " + persona.nome;
                img.style.width = "100px";
                link.appendChild(img);
                immagineCell.appendChild(link);
                colonna.appendChild(immagineCell);

                // Colonne dati
                var nomeCell = document.createElement("td");
                nomeCell.appendChild(document.createTextNode(persona.nome));
                colonna.appendChild(nomeCell);

                var cognomeCell = document.createElement("td");
                cognomeCell.appendChild(document.createTextNode(persona.cognome));
                colonna.appendChild(cognomeCell);

                var etaCell = document.createElement("td");
                etaCell.appendChild(document.createTextNode(persona.eta));
                colonna.appendChild(etaCell);

                var indirizzoCell = document.createElement("td");
                indirizzoCell.appendChild(document.createTextNode(persona.indirizzo));
                colonna.appendChild(indirizzoCell);

                var cittaCell = document.createElement("td");
                cittaCell.appendChild(document.createTextNode(persona.citta));
                colonna.appendChild(cittaCell);

                var telefono1Cell = document.createElement("td");
                telefono1Cell.appendChild(document.createTextNode(persona.telefoni?.[0] || ""));
                colonna.appendChild(telefono1Cell);

                var telefono2Cell = document.createElement("td");
                telefono2Cell.appendChild(document.createTextNode(persona.telefoni?.[1] || ""));
                colonna.appendChild(telefono2Cell);

                var sport1Cell = document.createElement("td");
                sport1Cell.appendChild(document.createTextNode(persona.sport?.[0] || ""));
                colonna.appendChild(sport1Cell);

                var sport2Cell = document.createElement("td");
                sport2Cell.appendChild(document.createTextNode(persona.sport?.[1] || ""));
                colonna.appendChild(sport2Cell);

                // Colonna portfolio
                var portfolioCell = document.createElement("td");
                var linkPortfolio = document.createElement("a");
                linkPortfolio.href = `portfolio.html?id=${persona.id}`;
                linkPortfolio.target = "_blank";
                var imgPortfolio = document.createElement("img");
                imgPortfolio.src = persona.portfolio || "placeholder_portfolio.png"; // Placeholder in caso di immagine mancante
                imgPortfolio.alt = "Portfolio di " + persona.nome;
                imgPortfolio.style.width = "100px";
                linkPortfolio.appendChild(imgPortfolio);
                portfolioCell.appendChild(linkPortfolio);
                colonna.appendChild(portfolioCell);

                // Aggiungi la riga alla tabella
                tabella.appendChild(colonna);
            });

            // Aggiungi la tabella al contenitore
            document.getElementById("stringaJSON").appendChild(tabella);
        }
    </script>
    
</body>
</html>

<html>
    <head>
        <link rel="stylesheet" href="Style.css">
    </head>

    <body>

        <div id="formIngr" class="generale"> 
            <div class="form">
                <h1 class="Titolo"> Anagrafica JSON </h1>
                <input type="button" onclick="caricaDati()" value="Carica dati">
            </div>
            <br>
        </div>

        <div id="risForm" style="display: none;">
            <div id="stringaJSON"> </div>
        </div>

    </body>

    <script>
        function caricaDati() {
            var file = new XMLHttpRequest();
            file.open("GET", "https://raw.githubusercontent.com/alelallox/JavaScript-Works/refs/heads/main/letturajson/datiAnagrafica.json", true);
            file.send();

            file.onreadystatechange = function() {
                if (this.readyState == 4 && this.status == 200) {
                    var jsonDoc = JSON.parse(file.responseText);
                    mostraInfo(jsonDoc);
                }
            };

            document.getElementById("formIngr").style.width = "0px";
            document.getElementById("formIngr").style.visibility = "hidden";
            document.getElementById("risForm").style.display = "block";  // Cambiato da visibility a display
        }

        function mostraInfo(ogg) {
            var tabella = document.createElement("table");
            var colonnaIndici = ["Immagine", "Nome", "Cognome", "Età", "Indirizzo", "Città", "Telefono 1", "Telefono 2", "Sport 1", "Sport 2"];
            var colonnaTit = document.createElement("tr");

            // Aggiungi intestazioni alla tabella
            for (let i = 0; i < colonnaIndici.length; i++) {
                var righe = document.createElement("th");
                righe.appendChild(document.createTextNode(colonnaIndici[i]));
                colonnaTit.appendChild(righe);
            }

            tabella.appendChild(colonnaTit);

            // Itera sui dati e crea le righe della tabella
            for (let i = 0; i < 3; i++) {
                var colonna = document.createElement("tr");

                // Dati dell'utente
                var rigaNome = document.createElement("td");
                rigaNome.appendChild(document.createTextNode(ogg.Anagrafica[i].Nome));

                var rigaCognome = document.createElement("td");
                rigaCognome.appendChild(document.createTextNode(ogg.Anagrafica[i].Cognome));

                var rigaEta = document.createElement("td");
                rigaEta.appendChild(document.createTextNode(ogg.Anagrafica[i].Eta));

                var rigaIndirizzo = document.createElement("td");
                rigaIndirizzo.appendChild(document.createTextNode(ogg.Anagrafica[i].Indirizzo));

                var rigaCitta = document.createElement("td");
                rigaCitta.appendChild(document.createTextNode(ogg.Anagrafica[i].Citta));

                var rigaTelefono1 = document.createElement("td");
                rigaTelefono1.appendChild(document.createTextNode(ogg.Anagrafica[i].Telefoni[0]?.Telefono1 || ""));

                var rigaTelefono2 = document.createElement("td");
                rigaTelefono2.appendChild(document.createTextNode(ogg.Anagrafica[i].Telefoni[1]?.Telefono2 || ""));

                var rigaSport1 = document.createElement("td");
                rigaSport1.appendChild(document.createTextNode(ogg.Anagrafica[i].Sport[0]?.Sport1 || ""));

                var rigaSport2 = document.createElement("td");
                rigaSport2.appendChild(document.createTextNode(ogg.Anagrafica[i].Sport[1]?.Sport2 || ""));

                // Crea la colonna dell'immagine
                var imgCell = document.createElement("td");
                var bottone = document.createElement("img");
                bottone.src = ogg.Anagrafica[i].Immagine || "";
                bottone.classList.add("immagineProfilo");

                // Evento click sull'immagine
                bottone.addEventListener("click", function() {
                    localStorage.setItem("id", ogg.Anagrafica[i].id);
                    console.log("Bottone premuto");
                    window.location.href = "cv.html";
                });

                imgCell.appendChild(bottone);
                colonna.appendChild(imgCell);

                // Aggiungi le altre colonne
                colonna.appendChild(rigaNome);
                colonna.appendChild(rigaCognome);
                colonna.appendChild(rigaEta);
                colonna.appendChild(rigaIndirizzo);
                colonna.appendChild(rigaCitta);
                colonna.appendChild(rigaTelefono1);
                colonna.appendChild(rigaTelefono2);
                colonna.appendChild(rigaSport1);
                colonna.appendChild(rigaSport2);

                // Aggiungi la riga alla tabella
                tabella.appendChild(colonna);
            }

            // Aggiungi la tabella alla pagina
            document.getElementById("stringaJSON").appendChild(tabella);
        }
    </script>

</html>
